---
import BookGrid from '../components/BookGrid.astro';
import FilterBar from '../components/FilterBar.astro';
import librosData from '../data/libros.json';
import '../styles/global.css';

const totalLibros = librosData.length;
const librosLeidos = librosData.filter(book => book.readDate).length;
const librosPendientes = totalLibros - librosLeidos;

// SEO metadata
const siteTitle = 'Libros | FIL GDL 2025';
const siteDescription = `Colección de ${totalLibros} libros adquiridos en la Feria Internacional del Libro de Guadalajara 2025. Los libros leídos (${librosLeidos}) se muestran a color, mientras que los pendientes (${librosPendientes}) aparecen en escala de grises.`;
const siteUrl = 'https://fil25.vic.monster'; // Actualizar con la URL real del sitio
const siteImage = `${siteUrl}/books/7_ensayos.webp`; // Imagen representativa
---

<html lang="es">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="generator" content={Astro.generator} />
		
		<!-- Primary Meta Tags -->
		<title>{siteTitle}</title>
		<meta name="title" content={siteTitle} />
		<meta name="description" content={siteDescription} />
		<meta name="author" content="Vic" />
		
		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="website" />
		<meta property="og:url" content={siteUrl} />
		<meta property="og:title" content={siteTitle} />
		<meta property="og:description" content={siteDescription} />
		<meta property="og:image" content={siteImage} />
		<meta property="og:locale" content="es_MX" />
		<meta property="og:site_name" content="FIL 2025 - Libros" />
		
		<!-- Twitter -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:url" content={siteUrl} />
		<meta name="twitter:title" content={siteTitle} />
		<meta name="twitter:description" content={siteDescription} />
		<meta name="twitter:image" content={siteImage} />
		
		<!-- Schema.org JSON-LD -->
		<script type="application/ld+json" set:html={JSON.stringify({
			"@context": "https://schema.org",
			"@type": "CollectionPage",
			"name": siteTitle,
			"description": siteDescription,
			"url": siteUrl,
			"image": siteImage,
			"mainEntity": {
				"@type": "ItemList",
				"numberOfItems": totalLibros,
				"itemListElement": librosData.map((book, index) => ({
					"@type": "ListItem",
					"position": index + 1,
					"item": {
						"@type": "Book",
						"name": book.title,
						"description": book.subtitle || `${book.title} por ${book.author.join(', ')}`,
						"author": book.author.map(author => ({
							"@type": "Person",
							"name": author
						})),
						"publisher": book.publishers.map(publisher => ({
							"@type": "Organization",
							"name": publisher
						})),
						...(book.image && {
							"image": `${siteUrl}${book.image}`
						})
					}
				}))
			}
		})} />
	</head>
	<body>
	<main>
		<h1>Libros | Feria Internacional de Libro de Guadalajara 2025</h1>
		<p class="intro">
			Colección de {totalLibros} libros adquiridos en la Feria Internacional del Libro de Guadalajara 2025. 
			Los libros leídos ({librosLeidos}) se muestran a color, mientras que los pendientes ({librosPendientes}) aparecen en escala de grises.
		</p>
		<FilterBar books={librosData} />
		<BookGrid books={librosData} />
	</main>
	</body>
</html>
